##  Возможности

- **Потоковая загрузка файлов**: Эффективная передача файлов любого размера
- **Потоковое скачивание файлов**: Передача с разбиением на части для оптимальной производительности
- **Управление файлами**: Просмотр списка файлов и их удаление
- **Метаданные в PostgreSQL**: Хранение информации о файлах в реляционной БД
- **Отказоустойчивость**: Гибкая архитектура, позволяющая работать с БД или без неё
- **Управление нагрузкой**: Лимитирование параллельных операций через интерцепторы gRPC
- **Миграции базы данных**: Встроенная система миграций для управления схемой БД

##  Структура проекта

```
├── api/                       # API определения
│   └── grpc/                  # Protobuf файлы gRPC сервисов
├── cmd/                       # Точки входа приложения
│   └── main.go                # Главный файл запуска сервера
├── internal/                  # Внутренняя логика приложения
│   ├── config/                # Конфигурация приложения
│   ├── controller/            # gRPC контроллеры и интерцепторы
│   ├── models/                # Модели данных
│   ├── repository/            # Слой доступа к данным
│   │   ├── disk_storage/      # Хранение файлов на диске
│   │   └── pg/                # PostgreSQL репозиторий 
│   └── usecase/               # Бизнес-логика сервиса
├── pkg/                       # Пакеты для внешнего использования
│   └── api/                   # Сгенерированный gRPC код
├── uploads/                   # Директория для хранения файлов
├── migrations/                # SQL миграции для базы данных
├── bin/                       # Скомпилированные бинарные файлы
├── Makefile                   # Автоматизация задач разработки
├── buf.yaml                   # Конфигурация Buf для работы с Protobuf
├── buf.gen.yaml               # Настройки генерации кода Protobuf
├── buf.lock                   # Lock-файл зависимостей Buf
├── config.yaml                # Конфигурационный файл приложения
└── docker-compose.yml         # Конфигурация Docker для запуска PostgreSQL
```

##  Технический стек

- **Go 1.23+** — Современный язык программирования с развитой экосистемой
- **gRPC** — Высокопроизводительный фреймворк для удалённого вызова процедур
- **Protocol Buffers** — Эффективный формат сериализации данных
- **PostgreSQL** — Надёжная реляционная база данных
- **PGX** — Высокопроизводительный драйвер для PostgreSQL в Go
- **Viper** — Библиотека для управления конфигурацией
- **Docker** — Контейнеризация компонентов приложения
- **Buf** — Современный инструмент для работы с Protocol Buffers
- **migrate** — Управление миграциями базы данных

##  Установка и запуск

### Предварительные требования

- Go 1.23 или выше
- Docker и Docker Compose
- Make

### Шаги для запуска

1. **Клонирование репозитория**
   ```bash
   git clone https://github.com/AVY963/tages.git
   cd tages
   ```

2. **Установка инструментов разработки**
   ```bash
   make install
   ```

3. **Запуск PostgreSQL в Docker**
   ```bash
   make db-up
   ```

4. **Применение миграций базы данных**
   ```bash
   make migrate-up
   ```

5. **Запуск сервера**
   ```bash
   make run
   ```
   Сервер будет запущен на порту, указанном в конфигурационном файле (по умолчанию 50051).

##  API сервиса

Сервис предоставляет следующие gRPC-методы:

```protobuf
service FileService {
  rpc Upload(stream FileChunk) returns (UploadStatus);     // Загрузка файлов
  rpc Download(FileRequest) returns (stream FileChunk);    // Скачивание файлов
  rpc List(google.protobuf.Empty) returns (FileList);      // Просмотр списка файлов
  rpc Delete(FileRequest) returns (DeleteStatus);          // Удаление файла
}
```

##  Конфигурация

Настройки приложения хранятся в `config.yaml`:

```yaml
app:
  upload_dir: "uploads"
  upload_limiter_concurrency: 5
  list_limiter_concurrency: 10

grpc:
  port: "50051"

pg:
  host: "localhost"
  port: "5432"
  user: "postgres"
  password: "postgres"
  database: "files_db"
```
